"use strict";(self.webpackChunkDentalClinic=self.webpackChunkDentalClinic||[]).push([[993],{2993:(O,f,s)=>{s.r(f),s.d(f,{VisitsModule:()=>Y});var y=s(6019),u=s(3886),l=s(6693),p=s(4753),D=s(9468),Z=s(9463),t=s(3668),o=s(9133),T=s(166),b=s(2782),A=s(2215),x=s(4300),S=s(6999),g=s(888),m=s(8167),C=s(138),d=s(8727),U=s(4751);function R(a,h){if(1&a&&(t.TgZ(0,"div"),t._UZ(1,"canvas",11),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("datasets",e.chartData)("labels",e.charLabels)("options",e.chartOptions)("plugins",e.chartPlugins)("chartType",e.chartType)}}const V=[{path:"",component:(()=>{class a{constructor(e,r,n,i,v,c,L){this.formBuilder=e,this.authService=r,this.appText=n,this.progressbarService=i,this.repository=v,this.router=c,this.breakPointObserver=L,this.visitForm=this.formBuilder.group({startDate:[""],endDate:[""]}),this.getRandomColor=()=>`#${Math.random().toString(16).slice(-6)}`,this.Texts=this.appText.getAppTexts(),this.renderChart=!1,this.chartsColor=[],this.chartOptions={responsive:!0,aspectRatio:1,animation:{animateRotate:!0,duration:4e3,easing:"easeOutQuart"}},this.chartType="bar",this.chartPlugins=[],this.startDate=this.visitForm.controls.startDate,this.endDate=this.visitForm.controls.endDate,(0,l.bF)(),(0,l.Dy)()}ngOnInit(){this.registerListeners(),this.fetchData()}fetchData(){this.progressbarService.showProgressbar(),this.repository.ReportRepository.getVisitCountRange(this.startdateSearchKey,this.enddateSearchKey).pipe((0,p.U)(e=>{this.chartData=[{data:e.map(r=>r.sum),backgroundColor:e.map(r=>this.getRandomColor())}],this.charLabels=e.map(r=>r.operation),this.renderChart=!0,setTimeout(()=>this.progressbarService.hideProgressbar())}),(0,D.q)(1)).subscribe()}registerListeners(){this.startDateChangeEvent=this.startDate.valueChanges.pipe((0,Z.b)(1e3),(0,p.U)(e=>{this.startdateSearchKey=`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`,this.fetchData()})).subscribe(),this.endDateChangeEvent=this.endDate.valueChanges.pipe((0,Z.b)(1e3),(0,p.U)(e=>{this.enddateSearchKey=`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`,this.fetchData()})).subscribe()}toExcel(){this.progressbarService.showProgressbar(),this.repository.ReportRepository.getVisitCountRange(this.startdateSearchKey,this.enddateSearchKey).pipe((0,p.U)(e=>{let r="Operation,Sum\n";e.forEach(c=>r+=`${c.operation},${c.sum}\n`);const n=new Blob([this.s2ab(atob(r))],{type:""}),i=document.createElement("a"),v=URL.createObjectURL(n);i.href=v,i.download="file",document.body.appendChild(i),i.click(),this.charLabels=e.map(c=>c.operation),setTimeout(()=>this.progressbarService.hideProgressbar())}),(0,D.q)(1)).subscribe()}s2ab(e){const r=new ArrayBuffer(e.length),n=new Uint8Array(r);for(let i=0;i<e.length;i-=-1)n[i]=255&e.charCodeAt(i);return r}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(o.qu),t.Y36(T.$),t.Y36(b.u),t.Y36(A.v),t.Y36(x.b),t.Y36(u.F0),t.Y36(S.Yg))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-visits"]],decls:24,vars:15,consts:[[1,"form-container"],[1,"searchBar"],[3,"formGroup"],["appearance","outline"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["myDatePicker1",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["myDatePicker",""],[1,"flex-box-show"],[4,"ngIf"],["height","540","width","800","baseChart","",3,"datasets","labels","options","plugins","chartType"]],template:function(e,r){if(1&e&&(t.TgZ(0,"mat-card-title"),t._uU(1),t.ALo(2,"Translate"),t.qZA(),t.TgZ(3,"div",0),t.TgZ(4,"div",1),t.TgZ(5,"form",2),t.TgZ(6,"mat-form-field",3),t.TgZ(7,"mat-label"),t._uU(8),t.ALo(9,"Translate"),t.qZA(),t._UZ(10,"input",4),t._UZ(11,"mat-datepicker-toggle",5),t._UZ(12,"mat-datepicker",null,6),t.qZA(),t.TgZ(14,"mat-form-field",3),t.TgZ(15,"mat-label"),t._uU(16),t.ALo(17,"Translate"),t.qZA(),t._UZ(18,"input",7),t._UZ(19,"mat-datepicker-toggle",5),t._UZ(20,"mat-datepicker",null,8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(22,"mat-card-content",9),t.YNc(23,R,2,5,"div",10),t.qZA(),t.qZA()),2&e){const n=t.MAs(13),i=t.MAs(21);t.xp6(1),t.Oqu(t.lcZ(2,9,r.Texts.Visits)),t.xp6(4),t.Q6J("formGroup",r.visitForm),t.xp6(3),t.Oqu(t.lcZ(9,11,r.Texts.StartDate)),t.xp6(2),t.Q6J("matDatepicker",n),t.xp6(1),t.Q6J("for",n),t.xp6(5),t.Oqu(t.lcZ(17,13,r.Texts.EndDate)),t.xp6(2),t.Q6J("matDatepicker",i),t.xp6(1),t.Q6J("for",i),t.xp6(4),t.Q6J("ngIf",r.renderChart)}},directives:[g.n5,o._Y,o.JL,o.sg,m.KE,m.hX,C.Nt,o.Fj,d.hl,o.JJ,o.u,d.nW,m.R9,d.Mq,g.dn,y.O5,l.jh],pipes:[U.v],styles:[""]}),a})()}];let F=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[u.Bz.forChild(V)],u.Bz]}),a})();var M=s(8191),J=s(9112);let Y=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[[y.ez,F,l.m9,g.QW,M.I,o.UX,d.FA,m.lN,C.c,J.Ps]]}),a})()}}]);